# プレゼント交換サポートWebアプリ 要件定義書

## 1. プロジェクト概要

### 1.1 目的

プレゼント交換会の進行をスムーズにサポートするWebアプリケーションを提供する。
司会者が抽選を行い、参加者がリアルタイムで当選結果を確認できる仕組みを実現する。

### 1.2 背景

プレゼント交換会において、公平な抽選と円滑な進行を実現するためのデジタルツールが求められている。
紙のくじ引きでは視認性や公平性の担保が難しく、参加者全員が同時に結果を確認できる仕組みが望ましい。

### 1.3 スコープ

- **対象**: オフライン/オンラインのプレゼント交換イベント
- **想定規模**: 5〜50名程度の参加者
- **利用シーン**: 忘年会、クリスマスパーティー、社内イベントなど

## 2. ステークホルダー定義

| ステークホルダー | 役割 | 期待値 |
|------------------|------|--------|
| 参加者 | プレゼント交換会の参加者 | 簡単にアクセスでき、自分の抽選番号と当選結果を確認できる |
| 司会者 | イベント進行役 | 抽選を簡単に実行でき、進行状況を管理できる |
| 主催者 | イベント企画者 | セッションを作成し、参加者に共有できる |

## 3. 機能要件

### 3.1 セッション管理機能

| ID | 要件 | 優先度 | 説明 |
|----|------|--------|------|
| FR-001 | セッション作成 | 必須 | 司会者/主催者が新しいプレゼント交換セッションを作成できる |
| FR-002 | セッションURL発行 | 必須 | 参加者がアクセスするための一意なURLを発行する |
| FR-003 | 参加者数設定 | 必須 | セッション作成時に参加者数を設定できる（5〜50名） |

### 3.2 参加者機能

| ID | 要件 | 優先度 | 説明 |
|----|------|--------|------|
| FR-101 | セッション参加 | 必須 | URLにアクセスすることでセッションに参加できる |
| FR-102 | 抽選番号表示 | 必須 | 参加時に一意な抽選番号が自動的に割り当てられ、画面に表示される |
| FR-103 | 名前入力 | 推奨 | 参加時に任意で名前を入力できる（表示用） |
| FR-104 | 当選結果表示 | 必須 | 自分が当選した場合、画面にリアルタイムで当選表示される |
| FR-105 | 抽選状況確認 | 推奨 | 現在の抽選状況（何回目の抽選か、残り人数など）を確認できる |

### 3.3 司会者機能

| ID | 要件 | 優先度 | 説明 |
|----|------|--------|------|
| FR-201 | 司会者モード | 必須 | 司会者専用の操作画面にアクセスできる |
| FR-202 | 抽選実行 | 必須 | ボタン操作で1名の当選者を抽選できる |
| FR-203 | 参加者一覧表示 | 必須 | 現在の参加者一覧と抽選状況を確認できる |
| FR-204 | 抽選結果表示 | 必須 | 当選者の番号（と名前）を画面に表示できる |
| FR-205 | 抽選リセット | 推奨 | 抽選をやり直すことができる |
| FR-206 | 抽選完了表示 | 必須 | 全員の抽選が完了したことを表示する |

### 3.4 リアルタイム通信機能

| ID | 要件 | 優先度 | 説明 |
|----|------|--------|------|
| FR-301 | リアルタイム同期 | 必須 | 抽選結果が参加者の画面にリアルタイムで反映される |
| FR-302 | 接続状態表示 | 推奨 | 参加者画面に接続状態を表示する |
| FR-303 | 再接続機能 | 必須 | 接続が切れた場合、自動的に再接続を試みる |

## 4. 非機能要件

### 4.1 性能要件

| ID | 要件 | 優先度 | 基準 |
|----|------|--------|------|
| NFR-001 | ページ読み込み時間 | 必須 | 初回アクセス時3秒以内 |
| NFR-002 | 抽選結果反映時間 | 必須 | 抽選実行から参加者画面への反映まで1秒以内 |
| NFR-003 | 同時接続数 | 必須 | 最大50名の同時接続をサポート |

### 4.2 可用性要件

| ID | 要件 | 優先度 | 基準 |
|----|------|--------|------|
| NFR-101 | サービス稼働率 | 推奨 | イベント中の稼働率99%以上 |
| NFR-102 | 障害復旧 | 推奨 | 接続断から30秒以内に自動再接続 |

### 4.3 ユーザビリティ要件

| ID | 要件 | 優先度 | 基準 |
|----|------|--------|------|
| NFR-201 | モバイル対応 | 必須 | スマートフォンからのアクセスに対応（レスポンシブデザイン） |
| NFR-202 | ブラウザ対応 | 必須 | 主要ブラウザ（Chrome, Safari, Firefox, Edge）の最新版に対応 |
| NFR-203 | アプリインストール不要 | 必須 | ブラウザのみでアクセス可能 |
| NFR-204 | 直感的操作 | 必須 | 説明なしで参加者が操作できるシンプルなUI |

### 4.4 セキュリティ要件

| ID | 要件 | 優先度 | 基準 |
|----|------|--------|------|
| NFR-301 | セッション分離 | 必須 | 異なるセッション間でデータが混在しない |
| NFR-302 | 司会者認証 | 推奨 | 司会者モードへのアクセスに簡易的な認証（パスコードなど） |
| NFR-303 | 通信暗号化 | 必須 | HTTPS通信を使用 |

### 4.5 保守性要件

| ID | 要件 | 優先度 | 基準 |
|----|------|--------|------|
| NFR-401 | コード品質 | 推奨 | TypeScript使用による型安全性の確保 |
| NFR-402 | テスト整備 | 推奨 | 主要機能のユニットテストを整備 |

## 5. 制約条件

### 5.1 技術的制約

| ID | 制約 | 理由 |
|----|------|------|
| C-001 | Webブラウザで動作すること | インストール不要で参加者の負担を軽減 |
| C-002 | リアルタイム通信の実装 | WebSocketまたはServer-Sent Eventsを使用 |

### 5.2 運用上の制約

| ID | 制約 | 理由 |
|----|------|------|
| C-101 | セッションデータは一時的 | イベント終了後のデータ保持は不要（コスト削減） |
| C-102 | 単一イベント対応 | 1セッションで1つのプレゼント交換会を管理 |

## 6. 前提条件

| ID | 前提条件 |
|----|----------|
| A-001 | 参加者はスマートフォンまたはPCを所持している |
| A-002 | 参加者はインターネット接続環境がある |
| A-003 | 司会者が抽選の進行を管理する |
| A-004 | プレゼントの物理的なやり取りはアプリ外で行う |

## 7. 用語定義

| 用語 | 定義 |
|------|------|
| セッション | 1回のプレゼント交換イベントを管理する単位 |
| 抽選番号 | 参加者に割り当てられる一意な番号（1から連番） |
| 当選 | 抽選で選ばれること。当選者はプレゼントを選ぶ権利を得る |
| 司会者 | 抽選を実行し、イベントを進行する役割の人 |

## 8. 要件依存関係

```
FR-001 (セッション作成)
  └── FR-002 (URL発行)
        └── FR-101 (セッション参加)
              ├── FR-102 (抽選番号表示)
              └── FR-103 (名前入力)

FR-201 (司会者モード)
  ├── FR-202 (抽選実行)
  │     └── FR-301 (リアルタイム同期)
  │           └── FR-104 (当選結果表示)
  ├── FR-203 (参加者一覧表示)
  └── FR-204 (抽選結果表示)
```

## 9. 抜け漏れチェックリスト

要件定義の完全性を確認するためのチェックリスト：

- [x] プロジェクトの目的と背景が明確か
- [x] すべてのステークホルダーが特定されているか
- [x] 機能要件が具体的かつ検証可能か
- [x] 非機能要件に定量的な基準があるか
- [x] 制約条件と前提条件が明記されているか
- [x] 要件間の依存関係が明確か
- [x] 用語の定義が統一されているか
- [x] 優先度が設定されているか

## 10. 次のステップ

1. 本要件定義書のレビューと承認
2. `/prj-define-design` コマンドによる技術設計書の作成
3. 実装フェーズへの移行
